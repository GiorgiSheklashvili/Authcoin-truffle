<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for C:/Users/giusha9/Desktop/Authcoin-Qtum-master-old-version/contracts/AuthCoin.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../../../../prettify.css" />
    <link rel="stylesheet" href="../../../../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../../../../index.html">all files</a> / <a href="index.html">C:/Users/giusha9/Desktop/Authcoin-Qtum-master-old-version/contracts/</a> AuthCoin.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">30.16% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>19/63</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">19.57% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>9/46</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">50% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>7/14</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">30.88% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>21/68</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-yes">20×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">18×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-yes">15×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">38×</span>
<span class="cline-any cline-yes">38×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">38×</span>
<span class="cline-any cline-yes">38×</span>
<span class="cline-any cline-yes">38×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">7×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">pragma solidity ^0.4.17;
&nbsp;
&nbsp;
import "installed_contracts/zeppelin/contracts/ownership/Ownable.sol";
import "./EntityIdentityRecord.sol";
import "./ValidationAuthenticationEntry.sol";
import "./signatures/SignatureVerifier.sol";
import "./signatures/DummyVerifier.sol";
&nbsp;
&nbsp;
/**
* @title AuthCoin
* @dev Main entry point for Authcoin protocol. Authcoin is an alternative approach to the commonly used public key infrastructures
* such as central authorities and the PGP web of trust. It combines a challenge response-based validation and authentication process
* for domains, certificates, email accounts and public keys with the advantages of a block chain-based storage system. Due to its
* transparent nature and public availability, it is possible to track the whole validation and authentication process history of each
* entity in the Authcoin system which makes it much more difficult to introduce sybil nodes and prevent such nodes from getting
* detected by genuine users.
*
* This contract can be used to register new entity identity records, create challenges and challenge responses and add challenge
* signature records. Also it supports revocation of entity identity and signature records.
*/
contract AuthCoin is Ownable {
&nbsp;
    // stores EIR values (eir_id =&gt; EntityIdentityRecord)
    mapping (bytes32 =&gt; EntityIdentityRecord) private eirIdToEir;
&nbsp;
    // stores the id's of Entity Identity Records
    bytes32[] private eirIdList;
&nbsp;
    // stores the values of ValidationAuthenticationEntry (vae_id =&gt; ValidationAuthenticationEntry)
    mapping (bytes32 =&gt; ValidationAuthenticationEntry) private vaeIdToVae;
&nbsp;
    // stores the id's of ValidationAuthenticationEntry
    bytes32[] private vaeIdList;
&nbsp;
    // stores known signature verifier contracts (eir type =&gt;  SignatureVerifier)
    mapping (bytes32 =&gt; SignatureVerifier) private signatureVerifiers;
&nbsp;
    // stores known signature verifier id's
    bytes32[] private verifierIdList;
&nbsp;
    event LogNewEir(bytes32 id, EntityIdentityRecord eir, bytes32 contentType);
&nbsp;
    event LogNewVae(address vaeAddress, bytes32 id);
&nbsp;
    event LogNewSignatureVerifier(SignatureVerifier a, bytes32 eirType);
&nbsp;
    function AuthCoin() {
        registerSignatureVerifier(new DummyVerifier(), bytes32("test"));
    }
&nbsp;
    /**
    * @dev Adds new EIR to the blockchain.
    */
    function registerEir(
        bytes _content,
        bytes32 _contentType,
        bytes32[] _identifiers, // e-mail address, username, age, etc
        bytes32 _hash,
        bytes _signature) public returns (bool)
    {
&nbsp;
        // ensure content type exists
        SignatureVerifier signatureVerifier = signatureVerifiers[_contentType];
        require(signatureVerifier != address(0));
&nbsp;
        // ensure EIR hash is correct
        require(keccak256(keccak256(_content), _contentType, _content, _identifiers, false) == _hash);
&nbsp;
        // ensure signature is correct
        require(signatureVerifier.verify(BytesUtils.bytes32ToString(_hash), _signature, _content));
&nbsp;
        // create new contract and store it
        EntityIdentityRecord eir = new EntityIdentityRecord(
            _identifiers,
            _content,
            _contentType,
            _hash,
            _signature,
            signatureVerifier,
            msg.sender
        );
&nbsp;
        // ensure it doesn't exist
        bytes32 id = eir.getId();
        require(eirIdToEir[id] == address(0));
&nbsp;
        eirIdToEir[id] = eir;
        eirIdList.push(id);
&nbsp;
        LogNewEir(id, eir, _contentType);
        return true;
    }
&nbsp;
<span class="fstat-no" title="function not covered" >    function revokeEir(bytes32 eirId, bytes revokingSignature) publi</span>c {
<span class="cstat-no" title="statement not covered" >        EntityIdentityRecord eir = eirIdToEir[eirId]</span>;
<span class="cstat-no" title="statement not covered" >        require(address(eir) != address(0))</span>;
        eir.revoke(revokingSignature);
    }
&nbsp;
    /**
    * @dev Adds a new challenge record to the blockchain.
    */
<span class="fstat-no" title="function not covered" >    function registerChallengeRecord(</span>
        bytes32 _id,
        bytes32 _vaeId,
        bytes32 _challengeType,
        bytes _challenge,
        bytes32 _verifierEir,
        bytes32 _targetEir,
        bytes32 _hash,
        bytes _signature) public returns (bool)
    {
&nbsp;
        // verifier exists
<span class="cstat-no" title="statement not covered" >        EntityIdentityRecord verifier = getEir(_verifierEir)</span>;
<span class="cstat-no" title="statement not covered" >        require(address(verifier) != address(0))</span>;
<span class="cstat-no" title="statement not covered" >        require(verifier.isRevoked() == false)</span>;
<span class="cstat-no" title="statement not covered" >        require(this == verifier.getCreator())</span>;
&nbsp;
        // target exists
<span class="cstat-no" title="statement not covered" >        EntityIdentityRecord target = getEir(_targetEir)</span>;
<span class="cstat-no" title="statement not covered" >        require(address(target) != address(0))</span>;
<span class="cstat-no" title="statement not covered" >        require(target.isRevoked() == false)</span>;
<span class="cstat-no" title="statement not covered" >        require(this == target.getCreator())</span>;
&nbsp;
        // ensure CR hash is correct
<span class="cstat-no" title="statement not covered" >        require(keccak256(_id, _vaeId, _challengeType, _challenge, _verifierEir, _targetEir) == _hash)</span>;
&nbsp;
        // ensure CR signature is correct
<span class="cstat-no" title="statement not covered" >        require(verifier.verifySignature(BytesUtils.bytes32ToString(_hash), _signature))</span>;
&nbsp;
        //TODO check if EIR is revoked or not.
&nbsp;
        // check VAE
<span class="cstat-no" title="statement not covered" >        ValidationAuthenticationEntry vae = vaeIdToVae[_vaeId]</span>;
<span class="cstat-no" title="statement not covered" >        bool isInitialized = (address(vae)!=address(0))</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (!isInitialized) {</span>
<span class="cstat-no" title="statement not covered" >            vae = new ValidationAuthenticationEntry(_vaeId, msg.sender)</span>;
<span class="cstat-no" title="statement not covered" >            vaeIdToVae[_vaeId] = vae</span>;
            vaeIdList.push(_vaeId);
<span class="cstat-no" title="statement not covered" >            LogNewVae(vae, _vaeId)</span>;
        } else {
<span class="cstat-no" title="statement not covered" >            require(this == vae.getCreator())</span>;
        }
&nbsp;
        vae.addChallengeRecord(_id,
            _vaeId,
            _challengeType,
            _challenge,
            verifier,
            target,
            _hash,
            _signature,
            msg.sender
        );
&nbsp;
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
&nbsp;
    /**
    * @dev Registers a challenge response record.
    */
<span class="fstat-no" title="function not covered" >    function registerChallengeResponse(</span>
        bytes32 _vaeId,
        bytes32 _challengeId,
        bytes _response,
        bytes32 _hash,
        bytes _signature) public returns (bool)
    {
<span class="cstat-no" title="statement not covered" >        ValidationAuthenticationEntry vae = vaeIdToVae[_vaeId]</span>;
<span class="cstat-no" title="statement not covered" >        require(address(vae) != address(0))</span>;
<span class="cstat-no" title="statement not covered" >        require(this == vae.getCreator())</span>;
&nbsp;
<span class="cstat-no" title="statement not covered" >        require(vae.addChallengeResponseRecord(</span>
            _vaeId,
            _challengeId,
            _response,
            _hash,
            _signature,
            msg.sender
        ));
&nbsp;
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
&nbsp;
    /**
    * @dev Registers a challenge response signature record.
    */
<span class="fstat-no" title="function not covered" >    function registerChallengeSignature(</span>
        bytes32 _vaeId,
        bytes32 _challengeId,
        uint _expirationBlock,
        bool _successful,
        bytes32 _hash,
        bytes _signature) public returns (bool)
    {
        // check vae id. vae must exist and should be in correct status.
<span class="cstat-no" title="statement not covered" >        ValidationAuthenticationEntry vae = vaeIdToVae[_vaeId]</span>;
<span class="cstat-no" title="statement not covered" >        require(address(vae) != address(0))</span>;
        // TODO: check correct status
&nbsp;
<span class="cstat-no" title="statement not covered" >        require(vae.addChallengeSignatureRecord(</span>
            _vaeId,
            _challengeId,
            _expirationBlock,
            _successful,
            _hash,
            _signature,
            msg.sender
        ));
&nbsp;
<span class="cstat-no" title="statement not covered" >        return true;</span>
    }
&nbsp;
    /**
    * @dev Registers signature verifier for some type of EIR. Registering EIR requires corresponding signature
    * verifier. If signature verifier is present then it will be overridden. Only the owner of the AuthCoin
    * contract can add new signature verifiers.
    *
    * @param signatureVerifier signature verifier address
    * @param eirType EIR type the signature verifier is implemented
    * @return true if signature verifier registration is successful.
    */
    function registerSignatureVerifier(SignatureVerifier signatureVerifier, bytes32 eirType) onlyOwner public returns (bool) {
        <span class="missing-if-branch" title="else path not taken" >E</span>if (address(signatureVerifiers[eirType]) == address(0)) {
            verifierIdList.push(eirType);
        }
        signatureVerifiers[eirType] = signatureVerifier;
        LogNewSignatureVerifier(signatureVerifier, eirType);
        return true;
    }
&nbsp;
    /**
    * @dev Returns registered signature verifier address. If eir type is unknown then zero address will be returned.
    */
    function getSignatureVerifier(bytes32 eirType) public view returns (SignatureVerifier) {
        return signatureVerifiers[eirType];
    }
&nbsp;
    /**
    * @dev Returns an array of registered signature verifier types.
    */
    function getSignatureVerifierTypes() public view returns (bytes32[]) {
        return verifierIdList;
    }
&nbsp;
    /**
    * @dev Returns the address of the EIR given id. This address can be used to access the actual EIR. Zero address will be
    * returned if EIR id is unknown.
    */
    function getEir(bytes32 eirId) public view returns (EntityIdentityRecord) {
        return eirIdToEir[eirId];
    }
&nbsp;
    /**
    * @dev Returns the validation and authentication entry for given VAE id. Zero address will be returned if VAE id is unknown.
    */
<span class="fstat-no" title="function not covered" >    function getVae(bytes32 vaeId) public view returns (ValidationAuthenticationEntry</span>) {
<span class="cstat-no" title="statement not covered" >        return vaeIdToVae[vaeId];</span>
    }
&nbsp;
    /**
    * @dev Returns the count of registered entity identity records
    */
    function getEirCount() public view returns (uint) {
        return eirIdList.length;
    }
&nbsp;
    /**
    * @dev Returns the count of registered validation and authentication entries.
    */
<span class="fstat-no" title="function not covered" >    function getVaeCount() public view returns (uint</span>) {
<span class="cstat-no" title="statement not covered" >        return vaeIdList.length;</span>
    }
&nbsp;
    /**
    * @dev Returns the validation and authentication entry array where EIR id is a participant (verifier or target).
    */
<span class="fstat-no" title="function not covered" >    function getVaeArrayByEirId(bytes32 eirId) public view returns (ValidationAuthenticationEntry[]</span>) {
        // solidity doesn't have dynamic arrays
<span class="cstat-no" title="statement not covered" >        ValidationAuthenticationEntry[] memory eieVaeArray = new ValidationAuthenticationEntry[](vaeIdList.length)</span>;
<span class="cstat-no" title="statement not covered" >        uint j = 0</span>;
<span class="cstat-no" title="statement not covered" >        for (uint i = 0; i &lt; vaeIdList.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >            ValidationAuthenticationEntry vae = vaeIdToVae[vaeIdList[i]]</span>;
<span class="cstat-no" title="statement not covered" >            if (vae.isParticipant(eirId)) {</span>
<span class="cstat-no" title="statement not covered" >                eieVaeArray[j] = vae</span>;
<span class="cstat-no" title="statement not covered" >                j = j+1</span>;
            }
        }
<span class="cstat-no" title="statement not covered" >        if (j == vaeIdList.length) {</span>
<span class="cstat-no" title="statement not covered" >            return eieVaeArray;</span>
        }
        // copy only known values
<span class="cstat-no" title="statement not covered" >        ValidationAuthenticationEntry[] memory eieVaeArray2 = new ValidationAuthenticationEntry[](j)</span>;
<span class="cstat-no" title="statement not covered" >        for (uint i2 = 0; i2 &lt; j; i2++) {</span>
<span class="cstat-no" title="statement not covered" >            eieVaeArray2[i2] = eieVaeArray[i2]</span>;
        }
<span class="cstat-no" title="statement not covered" >        return eieVaeArray2;</span>
    }
&nbsp;
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun Apr 07 2019 21:13:54 GMT+0300 (FLE Daylight Time)
</div>
</div>
<script src="../../../../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../../../../sorter.js"></script>
</body>
</html>
